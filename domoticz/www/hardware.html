<div id="hardwarecontent">
</div>
<div id="opentherm" style="display:none;">
	<center>
	<form id="openthermform">
		<br>
		<center>
			<span data-i18n="Outside Temperature Sensor">Outside Temperature Sensor</span>: <select id="combooutsidesensor" name="combooutsidesensor" style="width:300px" class="combobox ui-corner-all">
			</select>
			<br><br>
			<input type="hidden" id="idx" name="idx" value="-1">
			<button class="btn btn-danger" id="submitbuttonopentherm">Save</button>
		</center>
	</form>
	</center>
</div>
<div id="openzwave" style="display:none;">
	<div class="page-header-small">
		<table id="updelclr" border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td>
					<h1 data-i18n="Nodes">Nodes</h1>
				</td>
				<td align="right">
					<a class="btnstyle3" id="healnetwork" data-i18n="Heal network" onclick="ZWaveHealNetwork();">Heal network</a>&nbsp;&nbsp;&nbsp;
					<a class="btnstyle3" id="softresetdevice" data-i18n="Soft reset" onclick="ZWaveSoftResetNode();">Soft reset controller</a>&nbsp;&nbsp;&nbsp;
					<a class="btnstyle3" id="hardresetdevice" data-i18n="Hard reset" onclick="ZWaveHardResetNode();">Hard reset controller</a>&nbsp;&nbsp;&nbsp;
					<a class="btnstyle3" id="includedevice" data-i18n="Include Node" onclick="ZWaveIncludeNode();">Include Node</a>&nbsp;&nbsp;&nbsp;
					<a class="btnstyle3" id="excludedevice" data-i18n="Exclude Node" onclick="ZWaveExcludeNode();">Exclude Node</a>
				</td>
			</tr>
		</table>
	</div>
    <table class="display" id="nodestable" border="0" cellpadding="0" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th width="30" align="center" data-i18n="NodeID">NodeID</th>
                <th width="150" align="left" data-i18n="Name">Name</th>
                <th align="left" data-i18n="Description">Description</th>
                <th width="50" align="left" data-i18n="EnablePolling">EnablePolling</th>
                <th width="50" align="left" data-i18n="Status">Status</th>
            </tr>
        </thead>
    </table>
	<input type="hidden" id="idx" name="idx" value="-1">
    <table id="updelclr" border="0" cellpadding="0" cellspacing="0" width="100%">
		<tr>
			<td>
				<a class="btnstyle3-dis" id="nodeupdate" data-i18n="Update">Update</a>&nbsp;&nbsp;&nbsp;
				<a class="btnstyle3-dis" id="nodedelete" data-i18n="Delete">Delete</a>
			</td>
			<td align="right">
				<a class="btnstyle3" id="nodelistrefresh" data-i18n="Refresh" onclick="RefreshOpenZWaveNodeTable();">Refresh</a>
			</td>
		</tr>
	</table>
	<br>
	<table class="display" id="nodeparamstable" border="0" cellpadding="0" cellspacing="20">
		<tr>
			<td align="right" style="width:110px"><label for="name"><span data-i18n="Name"></span>:</label></td>
			<td><input type="text" id="nodename" style="width: 250px; padding: .2em;" class="text ui-widget-content ui-corner-all" /></td>
		</tr>
		<tr id="trEnablePolling">
			<td align="right" style="width:80px"><label for="EnablePolling"><span data-i18n="EnablePolling"></span>:</label></td>
			<td><input type="checkbox" id="EnablePolling" checked></td>
		</tr>
	</table>
	<br>
	<h2 data-i18n="Configuration">Configuration</h2>
	<br>
	<div id="configuration"></div>
</div>

<div id="rfxhardwaremode" style="display:none;">
<center>
<form id="settings">
	<table>
		<tr>
			<td align="left" style="width:150px"><input type="checkbox" id="undecon" name="undecon">&nbsp;<label for="undecon">undec on</label></td>
			<td align="left" style="width:150px"><input type="checkbox" id="BlindT1T2T3T4" name="BlindT1T2T3T4">&nbsp;<label for="BlindT1T2T3T4">Blind T1/T2/T3/T4</label></td>
			<td align="left" style="width:150px"><input type="checkbox" id="Visonic" name="Visonic">&nbsp;<label for="Visonic">Visonic</label></td>
		</tr>
		<tr>
			<td><input type="checkbox" id="rfu6" name="rfu6">&nbsp;<label for="rfu6">RFU 6</label></td>
			<td><input type="checkbox" id="BlindT0" name="BlindT0">&nbsp;<label for="BlindT0">Blind T0</label></td>
			<td><input type="checkbox" id="ATIremote" name="ATIremote">&nbsp;<label for="ATIremote">ATI remote</label></td>
		</tr>
		<tr>
			<td><input type="checkbox" id="ByronSX" name="ByronSX">&nbsp;<label for="ByronSX">Byron SX</label></td>
			<td><input type="checkbox" id="ProGuard" name="ProGuard">&nbsp;<label for="ProGuard">ProGuard</label></td>
			<td><input type="checkbox" id="OregonScientific" name="OregonScientific">&nbsp;<label for="OregonScientific">Oregon Scientific</label></td>
		</tr>
		<tr>
			<td><input type="checkbox" id="RSL" name="RSL">&nbsp;<label for="rfu4">Conrad RSL</label></td>
			<td><input type="checkbox" id="FS20" name="FS20">&nbsp;<label for="FS20">FS20</label></td>
			<td><input type="checkbox" id="Meiantech" name="Meiantech">&nbsp;<label for="Meiantech">Meiantech</label></td>
		</tr>
		<tr>
			<td><input type="checkbox" id="Lighting4" name="Lighting4">&nbsp;<label for="Lighting4">Lighting4</label></td>
			<td><input type="checkbox" id="LaCrosse" name="LaCrosse">&nbsp;<label for="LaCrosse">LaCrosse</label></td>
			<td><input type="checkbox" id="HomeEasyEU" name="HomeEasyEU">&nbsp;<label for="HomeEasyEU">HomeEasy EU</label></td>
		</tr>
		<tr>
			<td><input type="checkbox" id="FineOffsetViking" name="FineOffsetViking">&nbsp;<label for="FineOffsetViking">FineOffset/Viking</label></td>
			<td><input type="checkbox" id="HidekiUPM" name="HidekiUPM">&nbsp;<label for="HidekiUPM">Hideki/UPM</label></td>
			<td><input type="checkbox" id="AC" name="AC">&nbsp;<label for="AC">AC</label></td>
		</tr>
		<tr>
			<td><input type="checkbox" id="Rubicson" name="Rubicson">&nbsp;<label for="Rubicson">Rubicson</label></td>
			<td><input type="checkbox" id="ADLightwaveRF" name="ADLightwaveRF">&nbsp;<label for="ADLightwaveRF">AD/LightwaveRF</label></td>
			<td><input type="checkbox" id="ARC" name="ARC">&nbsp;<label for="ARC">ARC</label></td>
		</tr>
		<tr>
			<td><input type="checkbox" id="AEBlyss" name="AEBlyss">&nbsp;<label for="AEBlyss">AE/Blyss</label></td>
			<td><input type="checkbox" id="Mertik" name="Mertik">&nbsp;<label for="Mertik">Mertik</label></td>
			<td><input type="checkbox" id="X10" name="X10">&nbsp;<label for="X10">X10</label></td>
		</tr>
	</table>
	<br>
	<input type="hidden" id="idx" name="idx" value="-1">
	<button class="btn btn-warning" id="defaultbutton">Default</button>
	<button class="btn btn-danger" id="submitbutton">Set Mode</button>
</form>
</center>
</div>
<div id="rego6xxtypeedit" style="display:none;">
<center>
<form id="regotype">
    <table>
        <tr>
            <td><label>Rego 6XX type: </label></td>
            <td><select id="comborego6xxtype" name="Rego6XXType" style="width:200px" class="combobox ui-corner-all">
                <option value="0">600-635, 637 single language</option>
                <option value="1">636</option>
                <option value="2">637 multi language</option>
            </select></td>
        </tr>
        <tr><td colspan="2">Note: Any change will take effect after restarting Domoticz!</td></tr>
    </table>
	<br>
	<input type="hidden" id="idx" name="idx" value="-1">
	<button class="btn btn-danger" id="submitbuttonrego">Set Mode</button>
</form>
</center>
</div>
<div id="s0metertypeedit" style="display:none;">
<center>
<form id="s0metertype">
	<br>
	<h2><span data-i18n="Hardware">Hardware</span>:</h2>
	<table>
		<tr>
			<td align="right" style="width:60px"><label><span data-i18n="Baudrate">Baudrate</span>: </label></td>
			<td><select id="S0Baudrate" name="S0Baudrate" style="width:100px" class="combobox ui-corner-all">
				<option value="0">9600</option>
				<option value="1">115200</option>
			</select></td>
		</tr>
	</table>
	<br>
	<br>
	<h2>Meter 1:</h2>
	<table>
		<tr>
			<td align="right" style="width:60px"><label><span data-i18n="Type"></span>: </label></td>
			<td><select id="combom1type" name="S0M1Type" style="width:100px" class="combobox ui-corner-all">
				<option value="0">Energy</option>
				<option value="1">Gas</option>
				<option value="2">Water</option>
				<option value="3">Counter</option>
			</select></td>
		</tr>
		<tr>
			<td align="right" style="width:60px"><label><span data-i18n="Pulses/Hour"></span>: </label></td>
			<td><input type="input" id="M1PulsesPerHour" name="M1PulsesPerHour" style="width: 60px; padding: .2em;" class="text ui-widget-content ui-corner-all" /></td>
		</tr>
	</table>
	<br>
	<h2>Meter 2:</h2>
	<table>
		<tr>
			<td align="right" style="width:60px"><label><span data-i18n="Type"></span>: </label></td>
			<td><select id="combom2type" name="S0M2Type" style="width:100px" class="combobox ui-corner-all">
				<option value="0">Energy</option>
				<option value="1">Gas</option>
				<option value="2">Water</option>
				<option value="3">Counter</option>
			</select></td>
		</tr>
		<tr>
			<td align="right" style="width:60px"><label><span data-i18n="Pulses/Hour"></span>: </label></td>
			<td><input type="input" id="M2PulsesPerHour" name="M2PulsesPerHour" style="width: 60px; padding: .2em;" class="text ui-widget-content ui-corner-all" /></td>
		</tr>
	</table>
	<br>
	<input type="hidden" id="idx" name="idx" value="-1">
	<button class="btn btn-danger" id="submitbuttons0meter">Set Mode</button>
</form>
</center>
</div>
<div id="limitlessmetertype" style="display:none;">
	<center>
	<form id="limitform">
		<br>
		<center>
			<label><span data-i18n="Type"></span>: </label><select id="combom1type" name="LimitlessType" style="width:100px" class="combobox ui-corner-all">
				<option value="1">RGBW</option>
				<option value="2">RGB</option>
				<option value="3">White</option>
			</select>
			<br><br>
			<input type="hidden" id="idx" name="idx" value="-1">
			<button class="btn btn-danger" id="submitbuttonlimitless">Set Mode</button>
		</center>
	</form>
	</center>
</div>
<div id="hardwaremain" style="display:none;">
    <table class="display" id="hardwaretable" border="0" cellpadding="0" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th width="120" align="left" data-i18n="Name">Name</th>
                <th width="60" align="left" data-i18n="Enabled">Enabled</th>
                <th width="240" align="left" data-i18n="Type">Type</th>
                <th width="200" align="left" data-i18n="Address">Address</th>
                <th width="80" align="center" data-i18n="Port">Port</th>
            </tr>
        </thead>
    </table>
    <table id="updelclr" border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td>
					<a class="btnstyle3-dis" id="hardwareupdate" data-i18n="Update">Update</a>&nbsp;&nbsp;&nbsp;
					<a class="btnstyle3-dis" id="hardwaredelete" data-i18n="Delete">Delete</a>
				</td>
			</tr>
		</table>
		<br>
		<table class="display" id="hardwareparamstable" border="0" cellpadding="0" cellspacing="20">
			<tr>
				<td align="right" style="width:80px"><label for="enabled"><span data-i18n="Enabled"></span>:</label></td>
				<td><input type="checkbox" id="enabled" checked></td>
			</tr>
			<tr>
				<td align="right" style="width:110px"><label for="name"><span data-i18n="Name"></span>:</label></td>
				<td><input type="text" id="hardwarename" style="width: 250px; padding: .2em;" class="text ui-widget-content ui-corner-all" /></td>
			</tr>
			<tr>
				<td align="right" style="width:110px"><label for="name"><span data-i18n="Type"></span>:</label></td>
				<td><select id="combotype" style="width:410px" class="combobox ui-corner-all">
						<!--#embed hardwaretypes -->
						</select>
				</td>
			</tr>
		</table>
		<div id="divserial">
			<br>
			<table class="display" id="hardwareparamsserial" border="0" cellpadding="0" cellspacing="20">
				<tr>
					<td align="right" style="width:110px"><label id="lblserialport" for="name"><span data-i18n="Serial Port"></span>:</label></td>
					<td><select id="comboserialport" style="width:210px" class="combobox ui-corner-all">
							<!--#embed serialdevices -->
							</select>
					</td>
				</tr>
			</table>
		</div>
		<div id="divremote">
			<br>
			<table class="display" id="hardwareparamsremote" border="0" cellpadding="0" cellspacing="20">
				<tr>
					<td align="right" style="width:110px"><label id="lblremoteaddress" for="name"><span data-i18n="Remote Address"></span>:</label></td>
					<td><input type="text" id="tcpaddress" style="width: 250px; padding: .2em;" class="text ui-widget-content ui-corner-all" /></td>
				</tr>
				<tr>
					<td align="right" style="width:110px"><label id="lblremoteport" for="name"><span data-i18n="Port"></span>:</label></td>
					<td><input type="text" id="tcpport" style="width: 50px; padding: .2em;" class="text ui-widget-content ui-corner-all" /></td>
				</tr>
			</table>
		</div>
		<div id="divunderground">
			<br>
			<table class="display" id="hardwareparamsunderground" border="0" cellpadding="0" cellspacing="20">
				<tr>
					<td align="right" style="width:110px"><label><span data-i18n="API Key"></span>:</label></td>
					<td><input type="text" id="apikey" style="width: 250px; padding: .2em;" class="text ui-widget-content ui-corner-all" /></td>
				</tr>
				<tr>
					<td align="right" style="width:110px"><label><span data-i18n="Location"></span>:</label></td>
					<td><input type="text" id="location" style="width: 250px; padding: .2em;" class="text ui-widget-content ui-corner-all" /></td>
				</tr>
			</table>
		</div>
		<div id="divlogin">
			<br>
			<table class="display" id="hardwareparamslogin" border="0" cellpadding="0" cellspacing="20">
				<tr>
					<td align="right" style="width:110px"><label id="lblusername" for="name"><span data-i18n="Username"></span>:</label></td>
					<td><input type="text" id="username" style="width: 150px; padding: .2em;" class="text ui-widget-content ui-corner-all" />
				</tr>
				<tr>
					<td align="right" style="width:110px"><label id="lblpassword" for="name"><span data-i18n="Password"></span>:</label></td>
					<td><input type="password" id="password" style="width: 150px; padding: .2em;" class="text ui-widget-content ui-corner-all" />
				</tr>
			</table>
		</div>
		<br>
    <a class="btnstyle3" onclick="AddHardware();" data-i18n="Add">Add</a>
</div>
<div id="dialog-createsensor" title="Create Virtual Sensor" style="display:none;">
		<form>
				<label for="sensortype"><span data-i18n="Sensor Type"></span>: </label>
				<select id="sensortype" style="width:250px" class="combobox ui-corner-all">
					<option value="80" data-i18n="Temperature">Temperature</option>
					<option value="81" data-i18n="Humidity">Humidity</option>
					<option value="82" data-i18n="Temp+Hum">Temp+Hum</option>
					<option value="84" data-i18n="Temp+Hum+Baro">Temp+Hum+Baro</option>
					<option value="85" data-i18n="Rain">Rain</option>
					<option value="86" data-i18n="Wind">Wind</option>
					<option value="87" data-i18n="UV">UV</option>
					<option value="113" data-i18n="Counter">Counter</option>
					<option value="90" data-i18n="Electric (Instant+Counter)">Electric (Instant+Counter)</option>
				</select>
		</form>
</div>

<script type="text/javascript" charset="utf-8">

function DeleteHardware(idx)
{
	bootbox.confirm($.i18n("Are you sure to delete this Hardware?\n\nThis action can not be undone...\nAll Devices attached will be removed!"), function(result) {
		if (result==true) {
			$.ajax({
				 url: "json.htm?type=command&param=deletehardware&idx=" + idx,
				 async: false, 
				 dataType: 'json',
				 success: function(data) {
					RefreshHardwareTable();
				 },
				 error: function(){
						HideNotify();
						ShowNotify($.i18n('Problem deleting hardware!'), 2500, true);
				 }     
			});
		}
	});
}

function UpdateHardware(idx,Mode1,Mode2,Mode3,Mode4,Mode5)
{
	var name=$("#hardwarecontent #hardwareparamstable #hardwarename").val();
	if (name=="")
	{
		ShowNotify($.i18n('Please enter a Name!'), 2500, true);
		return;
	}

	var hardwaretype=$("#hardwarecontent #hardwareparamstable #combotype option:selected").val();
	if (typeof hardwaretype == 'undefined') {
		ShowNotify($.i18n('Unknown device selected!'), 2500, true);
		return;
	}
	
	var bEnabled=$('#hardwarecontent #hardwareparamstable #enabled').is(":checked");
	
	var text = $("#hardwarecontent #hardwareparamstable #combotype option:selected").text();
	if ((text.indexOf("TE923") >= 0)||(text.indexOf("Volcraft") >= 0)||(text.indexOf("1-Wire") >= 0)||(text.indexOf("BMP085") >= 0)||(text.indexOf("Dummy") >= 0)||(text.indexOf("PiFace") >= 0))
	{
		$.ajax({
			 url: "json.htm?type=command&param=updatehardware&htype=" + hardwaretype +
				"&port=1&name=" + name + 
				"&enabled=" + bEnabled + 
				"&idx=" + idx +
				"&Mode1=" + Mode1 + "&Mode2=" + Mode2 + "&Mode3=" + Mode3 + "&Mode4=" + Mode4 + "&Mode5=" + Mode5,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem updating hardware!'), 2500, true);
			 }     
		});
	}
	else if (text.indexOf("USB") >= 0)
	{
		var serialport=$("#hardwarecontent #divserial #comboserialport option:selected").val();
		if (typeof serialport == 'undefined')
		{
			ShowNotify($.i18n('No serial port selected!'), 2500, true);
			return;
		}
		$.ajax({
			 url: "json.htm?type=command&param=updatehardware&htype=" + hardwaretype +
				"&port=" + serialport + 
				"&name=" + name + 
				"&enabled=" + bEnabled + 
				"&idx=" + idx +
				"&Mode1=" + Mode1 + "&Mode2=" + Mode2 + "&Mode3=" + Mode3 + "&Mode4=" + Mode4 + "&Mode5=" + Mode5,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem updating hardware!'), 2500, true);
			 }     
		});
	}
	else if (text.indexOf("LAN") >= 0 && text.indexOf("YouLess") == -1)
	{
		var address=$("#hardwarecontent #divremote #tcpaddress").val();
		if (address=="")
		{
			ShowNotify($.i18n('Please enter an Address!'), 2500, true);
			return;
		}
		var port=$("#hardwarecontent #divremote #tcpport").val();
		if (port=="")
		{
			ShowNotify($.i18n('Please enter an Port!'), 2500, true);
			return;
		}
		var intRegex = /^\d+$/;
		if(!intRegex.test(port)) {
			ShowNotify($.i18n('Please enter an Valid Port!'), 2500, true);
			return;
		}		
		$.ajax({
			 url: "json.htm?type=command&param=updatehardware&htype=" + hardwaretype + 
				"&address=" + address + 
				"&port=" + port + 
				"&name=" + name + 
				"&enabled=" + bEnabled + 
				"&idx=" + idx + 
				"&Mode1=" + Mode1 + "&Mode2=" + Mode2 + "&Mode3=" + Mode3 + "&Mode4=" + Mode4 + "&Mode5=" + Mode5,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem updating hardware!'), 2500, true);
			 }     
		});
	}
	else if (text.indexOf("LAN") >= 0 && text.indexOf("YouLess") >= 0 )
	{
		var address=$("#hardwarecontent #divremote #tcpaddress").val();
		if (address=="")
		{
			ShowNotify($.i18n('Please enter an Address!'), 2500, true);
			return;
		}
		var port=$("#hardwarecontent #divremote #tcpport").val();
		if (port=="")
		{
			ShowNotify($.i18n('Please enter an Port!'), 2500, true);
			return;
		}
		var intRegex = /^\d+$/;
		if(!intRegex.test(port)) {
			ShowNotify($.i18n('Please enter an Valid Port!'), 2500, true);
			return;
		}
		var password=$("#hardwarecontent #divlogin #password").val();		
		$.ajax({
			 url: "json.htm?type=command&param=updatehardware&htype=" + hardwaretype + 
				"&address=" + address + 
				"&port=" + port + 
				"&name=" + name + 
				"&password=" + password +
				"&enabled=" + bEnabled + 
				"&idx=" + idx + 
				"&Mode1=" + Mode1 + "&Mode2=" + Mode2 + "&Mode3=" + Mode3 + "&Mode4=" + Mode4 + "&Mode5=" + Mode5,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem updating hardware!'), 2500, true);
			 }     
		});
	}
	else if (text.indexOf("Domoticz") >= 0)
	{
		var address=$("#hardwarecontent #divremote #tcpaddress").val();
		if (address=="")
		{
			ShowNotify($.i18n('Please enter an Address!'), 2500, true);
			return;
		}
		var port=$("#hardwarecontent #divremote #tcpport").val();
		if (port=="")
		{
			ShowNotify($.i18n('Please enter an Port!'), 2500, true);
			return;
		}
		var intRegex = /^\d+$/;
		if(!intRegex.test(port)) {
			ShowNotify($.i18n('Please enter an Valid Port!'), 2500, true);
			return;
		}		
		var username=$("#hardwarecontent #divlogin #username").val();
		var password=$("#hardwarecontent #divlogin #password").val();
		$.ajax({
			 url: "json.htm?type=command&param=updatehardware&htype=" + hardwaretype +
				"&address=" + address + 
				"&port=" + port + 
				"&username=" + username + 
				"&password=" + password + 
				"&name=" + name + 
				"&enabled=" + bEnabled + 
				"&idx=" + idx + 
				"&Mode1=" + Mode1 + "&Mode2=" + Mode2 + "&Mode3=" + Mode3 + "&Mode4=" + Mode4 + "&Mode5=" + Mode5,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem updating hardware!'), 2500, true);
			 }     
		});
	}
	else if ((text.indexOf("Underground") >= 0)||(text.indexOf("Forecast") >= 0))
	{
		var apikey=$("#hardwarecontent #divunderground #apikey").val();
		if (apikey=="")
		{
			ShowNotify($.i18n('Please enter an API Key!'), 2500, true);
			return;
		}
		var location=$("#hardwarecontent #divunderground #location").val();
		if (location=="")
		{
			ShowNotify($.i18n('Please enter an Location!'), 2500, true);
			return;
		}
		$.ajax({
			 url: "json.htm?type=command&param=updatehardware&htype=" + hardwaretype +
				"&port=1" + 
				"&username=" + apikey + 
				"&password=" + location +
				"&name=" + name + 
				"&enabled=" + bEnabled + 
				"&idx=" + idx +
				"&Mode1=" + Mode1 + "&Mode2=" + Mode2 + "&Mode3=" + Mode3 + "&Mode4=" + Mode4 + "&Mode5=" + Mode5,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem updating hardware!'), 2500, true);
			 }     
		});
	}
}

function AddHardware()
{
	var name=$("#hardwarecontent #hardwareparamstable #hardwarename").val();
	if (name=="")
	{
		ShowNotify($.i18n('Please enter a Name!'), 2500, true);
		return false;
	}

	var hardwaretype=$("#hardwarecontent #hardwareparamstable #combotype option:selected").val();
	if (typeof hardwaretype == 'undefined') {
		ShowNotify($.i18n('Unknown device selected!'), 2500, true);
		return;
	}
	
	var bEnabled=$('#hardwarecontent #hardwareparamstable #enabled').is(":checked");
	
	var text = $("#hardwarecontent #hardwareparamstable #combotype option:selected").text();
	if (text.indexOf("Motherboard") >= 0) {
		ShowNotify($.i18n('This device is maintained by the system. Please do not add it manually.'), 3000, true);
		return;
	}
	
	if ((text.indexOf("TE923") >= 0)||(text.indexOf("Volcraft") >= 0)||(text.indexOf("1-Wire") >= 0)||(text.indexOf("BMP085") >= 0)||(text.indexOf("Dummy") >= 0)||(text.indexOf("PiFace") >= 0))
	{
		$.ajax({
			 url: "json.htm?type=command&param=addhardware&htype=" + hardwaretype + "&port=1&name=" + name + "&enabled=" + bEnabled,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem adding hardware!'), 2500, true);
			 }     
		});
	}
	else if (text.indexOf("USB") >= 0)
	{
		var serialport=$("#hardwarecontent #divserial #comboserialport option:selected").val();
		if (typeof serialport == 'undefined')
		{
			ShowNotify($.i18n('No serial port selected!'), 2500, true);
			return;
		}
		$.ajax({
			 url: "json.htm?type=command&param=addhardware&htype=" + hardwaretype + "&port=" + serialport + "&name=" + name + "&enabled=" + bEnabled,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem adding hardware!'), 2500, true);
			 }     
		});
	}
	else if (text.indexOf("LAN") >= 0 && text.indexOf("YouLess") == -1)
	{
		var address=$("#hardwarecontent #divremote #tcpaddress").val();
		if (address=="")
		{
			ShowNotify($.i18n('Please enter an Address!'), 2500, true);
			return;
		}
		var port=$("#hardwarecontent #divremote #tcpport").val();
		if (port=="")
		{
			ShowNotify($.i18n('Please enter an Port!'), 2500, true);
			return;
		}
		var intRegex = /^\d+$/;
		if(!intRegex.test(port)) {
			ShowNotify($.i18n('Please enter an Valid Port!'), 2500, true);
			return;
		}		
		$.ajax({
			 url: "json.htm?type=command&param=addhardware&htype=" + hardwaretype + "&address=" + address + "&port=" + port + "&name=" + name + "&enabled=" + bEnabled,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem adding hardware!'), 2500, true);
			 }     
		});
	}
	else if (text.indexOf("LAN") >= 0 && text.indexOf("YouLess") >= 0)
	{
		var address=$("#hardwarecontent #divremote #tcpaddress").val();
		if (address=="")
		{
			ShowNotify($.i18n('Please enter an Address!'), 2500, true);
			return;
		}
		var port=$("#hardwarecontent #divremote #tcpport").val();
		if (port=="")
		{
			ShowNotify($.i18n('Please enter an Port!'), 2500, true);
			return;
		}
		var intRegex = /^\d+$/;
		if(!intRegex.test(port)) {
			ShowNotify($.i18n('Please enter an Valid Port!'), 2500, true);
			return;
		}
		var password=$("#hardwarecontent #divlogin #password").val();
		$.ajax({
			 url: "json.htm?type=command&param=addhardware&htype=" + hardwaretype + "&address=" + address + "&port=" + port + "&name=" + name + "&password=" + password + "&enabled=" + bEnabled,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem adding hardware!'), 2500, true);
			 }     
		});
	}
	else if (text.indexOf("Domoticz") >= 0)
	{
		var address=$("#hardwarecontent #divremote #tcpaddress").val();
		if (address=="")
		{
			ShowNotify($.i18n('Please enter an Address!'), 2500, true);
			return;
		}
		var port=$("#hardwarecontent #divremote #tcpport").val();
		if (port=="")
		{
			ShowNotify($.i18n('Please enter an Port!'), 2500, true);
			return;
		}
		var intRegex = /^\d+$/;
		if(!intRegex.test(port)) {
			ShowNotify($.i18n('Please enter an Valid Port!'), 2500, true);
			return;
		}		
		var username=$("#hardwarecontent #divlogin #username").val();
		var password=$("#hardwarecontent #divlogin #password").val();
		$.ajax({
			 url: "json.htm?type=command&param=addhardware&htype=" + hardwaretype + "&address=" + address + "&port=" + port + "&username=" + username + "&password=" + password + "&name=" + name + "&enabled=" + bEnabled,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem adding hardware!'), 2500, true);
			 }     
		});
	}
	else if ((text.indexOf("Underground") >= 0)||(text.indexOf("Forecast") >= 0))
	{
		var apikey=$("#hardwarecontent #divunderground #apikey").val();
		if (apikey=="")
		{
			ShowNotify($.i18n('Please enter an API Key!'), 2500, true);
			return;
		}
		var location=$("#hardwarecontent #divunderground #location").val();
		if (location=="")
		{
			ShowNotify($.i18n('Please enter an Location!'), 2500, true);
			return;
		}
		$.ajax({
			 url: "json.htm?type=command&param=addhardware&htype=" + hardwaretype + "&port=1" + "&username=" + apikey + "&password=" + location + "&name=" + name + "&enabled=" + bEnabled,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				RefreshHardwareTable();
			 },
			 error: function(){
					ShowNotify($.i18n('Problem adding hardware!'), 2500, true);
			 }     
		});
	}
}

function EditRFXCOMMode(idx,name,Mode1,Mode2,Mode3,Mode4,Mode5)
{
	cursordefault();
	var htmlcontent = '';
	htmlcontent='<p><center><h2><span data-i18n="Device"></span>: ' + name + '</h2></center></p>\n';
	htmlcontent+=$('#rfxhardwaremode').html();
	$('#hardwarecontent').html(GetBackbuttonHTMLTable('ShowHardware')+htmlcontent);
	$('#hardwarecontent').i18n();

	$('#hardwarecontent #submitbutton').click(function (e) {
		e.preventDefault();
		SetRFXCOMMode();
	});


	$('#hardwarecontent #idx').val(idx);
	$('#hardwarecontent #undecon').prop('checked',((Mode3 & 0x80)!=0));
	$('#hardwarecontent #X10').prop('checked',((Mode5 & 0x01)!=0));
	$('#hardwarecontent #ARC').prop('checked',((Mode5 & 0x02)!=0));
	$('#hardwarecontent #AC').prop('checked',((Mode5 & 0x04)!=0));
	$('#hardwarecontent #HomeEasyEU').prop('checked',((Mode5 & 0x08)!=0));
	$('#hardwarecontent #Meiantech').prop('checked',((Mode5 & 0x10)!=0));
	$('#hardwarecontent #OregonScientific').prop('checked',((Mode5 & 0x20)!=0));
	$('#hardwarecontent #ATIremote').prop('checked',((Mode5 & 0x40)!=0));
	$('#hardwarecontent #Visonic').prop('checked',((Mode5 & 0x80)!=0));
	$('#hardwarecontent #Mertik').prop('checked',((Mode4 & 0x01)!=0));
	$('#hardwarecontent #ADLightwaveRF').prop('checked',((Mode4 & 0x02)!=0));
	$('#hardwarecontent #HidekiUPM').prop('checked',((Mode4 & 0x04)!=0));
	$('#hardwarecontent #LaCrosse').prop('checked',((Mode4 & 0x08)!=0));
	$('#hardwarecontent #FS20').prop('checked',((Mode4 & 0x10)!=0));
	$('#hardwarecontent #ProGuard').prop('checked',((Mode4 & 0x20)!=0));
	$('#hardwarecontent #BlindT0').prop('checked',((Mode4 & 0x40)!=0));
	$('#hardwarecontent #BlindT1T2T3T4').prop('checked',((Mode4 & 0x80)!=0));
	$('#hardwarecontent #AEBlyss').prop('checked',((Mode3 & 0x01)!=0));
	$('#hardwarecontent #Rubicson').prop('checked',((Mode3 & 0x02)!=0));
	$('#hardwarecontent #FineOffsetViking').prop('checked',((Mode3 & 0x04)!=0));
	$('#hardwarecontent #Lighting4').prop('checked',((Mode3 & 0x08)!=0));
	$('#hardwarecontent #RSL').prop('checked',((Mode3 & 0x10)!=0));
	$('#hardwarecontent #ByronSX').prop('checked',((Mode3 & 0x20)!=0));
	$('#hardwarecontent #rfu6').prop('checked',((Mode3 & 0x40)!=0));

	$('#hardwarecontent #defaultbutton').click(function (e) {
		e.preventDefault();
		$('#hardwarecontent #undecon').prop('checked',false);
		$('#hardwarecontent #X10').prop('checked',true);
		$('#hardwarecontent #ARC').prop('checked',true);
		$('#hardwarecontent #AC').prop('checked',true);
		$('#hardwarecontent #HomeEasyEU').prop('checked',true);
		$('#hardwarecontent #Meiantech').prop('checked',false);
		$('#hardwarecontent #OregonScientific').prop('checked',true);
		$('#hardwarecontent #ATIremote').prop('checked',false);
		$('#hardwarecontent #Visonic').prop('checked',false);
		$('#hardwarecontent #Mertik').prop('checked',false);
		$('#hardwarecontent #ADLightwaveRF').prop('checked',false);
		$('#hardwarecontent #HidekiUPM').prop('checked',true);
		$('#hardwarecontent #LaCrosse').prop('checked',true);
		$('#hardwarecontent #FS20').prop('checked',false);
		$('#hardwarecontent #ProGuard').prop('checked',false);
		$('#hardwarecontent #BlindT0').prop('checked',false);
		$('#hardwarecontent #BlindT1T2T3T4').prop('checked',false);
		$('#hardwarecontent #AEBlyss').prop('checked',false);
		$('#hardwarecontent #Rubicson').prop('checked',false);
		$('#hardwarecontent #FineOffsetViking').prop('checked',false);
		$('#hardwarecontent #Lighting4').prop('checked',false);
		$('#hardwarecontent #RSL').prop('checked',false);
		$('#hardwarecontent #ByronSX').prop('checked',false);
		$('#hardwarecontent #rfu6').prop('checked',false);
	});
}

function EditRego6XXType(idx,name,Mode1,Mode2,Mode3,Mode4,Mode5)
{
	cursordefault();
	var htmlcontent = '';
	htmlcontent='<p><center><h2><span data-i18n="Device"></span>: ' + name + '</h2></center></p>\n';
	htmlcontent+=$('#rego6xxtypeedit').html();
	$('#hardwarecontent').html(GetBackbuttonHTMLTable('ShowHardware')+htmlcontent);
	$('#hardwarecontent').i18n();

	$('#hardwarecontent #submitbuttonrego').click(function (e) {
		e.preventDefault();
		SetRego6XXType();
	});

	$('#hardwarecontent #idx').val(idx);
	$('#hardwarecontent #comborego6xxtype').val(Mode1);
}

function EditS0MeterType(idx,name,Mode1,Mode2,Mode3,Mode4,Mode5)
{
	cursordefault();
	var htmlcontent = '';
	htmlcontent='<p><center><h2><span data-i18n="Device"></span>: ' + name + '</h2></center></p>\n';
	htmlcontent+=$('#s0metertypeedit').html();
	$('#hardwarecontent').html(GetBackbuttonHTMLTable('ShowHardware')+htmlcontent);
	$('#hardwarecontent').i18n();

	$('#hardwarecontent #submitbuttons0meter').click(function (e) {
		e.preventDefault();
		SetS0MeterType();
	});

	$('#hardwarecontent #idx').val(idx);
	$('#hardwarecontent #combom1type').val(Mode1);
	if (Mode2!=0) {
		$('#hardwarecontent #M1PulsesPerHour').val(Mode2);
	}
	else {
		$('#hardwarecontent #M1PulsesPerHour').val(2000);
	}

	$('#hardwarecontent #combom2type').val(Mode3);
	if (Mode4!=0) {
		$('#hardwarecontent #M2PulsesPerHour').val(Mode4);
	}
	else {
		$('#hardwarecontent #M2PulsesPerHour').val(2000);
	}
	$('#hardwarecontent #S0Baudrate').val(Mode5);
}

function EditLimitlessType(idx,name,Mode1,Mode2,Mode3,Mode4,Mode5)
{
	cursordefault();
	var htmlcontent = '';
	htmlcontent='<p><center><h2><span data-i18n="Device"></span>: ' + name + '</h2></center></p>\n';
	htmlcontent+=$('#limitlessmetertype').html();
	$('#hardwarecontent').html(GetBackbuttonHTMLTable('ShowHardware')+htmlcontent);
	$('#hardwarecontent').i18n();

	$('#hardwarecontent #submitbuttonlimitless').click(function (e) {
		e.preventDefault();
		SetLimitlessType();
	});

	$('#hardwarecontent #idx').val(idx);
	$('#hardwarecontent #combom1type').val(Mode1);
}

function DeleteNode(idx)
{
	if ($('#updelclr #nodedelete').attr("class")=="btnstyle3-dis") {
		return;
	}
	bootbox.confirm($.i18n("Are you sure to remove this Node?"), function(result) {
		if (result==true) {
		  $.ajax({
			url: "json.htm?type=command&param=deletezwavenode" +
				"&idx=" + idx,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				bootbox.alert($.i18n('Node marked for Delete. This could take some time!'));
				RefreshOpenZWaveNodeTable();
			 }
		  });
		}
	});
}

function UpdateNode(idx)
{
	if ($('#updelclr #nodeupdate').attr("class")=="btnstyle3-dis") {
		return;
	}
	var name=$("#hardwarecontent #nodeparamstable #nodename").val();
	if (name=="")
	{
		ShowNotify($.i18n('Please enter a Name!'), 2500, true);
		return;
	}

	var bEnablePolling=$('#hardwarecontent #nodeparamstable #EnablePolling').is(":checked");
	$.ajax({
		 url: "json.htm?type=command&param=updatezwavenode" +
			"&idx=" + idx +
			"&name=" + name + 
			"&EnablePolling=" + bEnablePolling,
		 async: false, 
		 dataType: 'json',
		 success: function(data) {
			RefreshOpenZWaveNodeTable();
		 },
		 error: function(){
			ShowNotify($.i18n('Problem updating Node!'), 2500, true);
		 }     
	});
}

function RequestZWaveConfiguration(idx)
{
	$.ajax({
		 url: "json.htm?type=command&param=requestzwavenodeconfig" +
			"&idx=" + idx,
		 async: false, 
		 dataType: 'json',
		 success: function(data) {
			bootbox.alert($.i18n('Configuration requested from Node. If the Node is asleep, this could take a while!'));
			RefreshOpenZWaveNodeTable();
		 },
		 error: function(){
				ShowNotify($.i18n('Problem requesting Node Configuration!'), 2500, true);
		 }     
	});
}

function ApplyZWaveConfiguration(idx)
{
	var valueList="";
	var $list = $('#hardwarecontent #configuration input');
	if (typeof $list != 'undefined') {
		var ControlCnt = $list.length;
		// Now loop through list of controls
		
		$list.each( function() {
			var id = $(this).prop("id");      // get id
			var value = $(this).prop("value");      // get value
			
			valueList+=id+"_"+value+"__";
		});
	}

	//Now for the Lists
	$list = $('#hardwarecontent #configuration select');
	if (typeof $list != 'undefined') {
		var ControlCnt = $list.length;
		// Now loop through list of controls
		$list.each( function() {
			var id = $(this).prop("id");      // get id
			var value = $(this).find(":selected").text();      // get value
			valueList+=id+"_"+value+"__";
		});
	}

	if (valueList!="") {
		$.ajax({
			 url: "json.htm?type=command&param=applyzwavenodeconfig" +
				"&idx=" + idx +
				"&valuelist=" + valueList,
			 async: false, 
			 dataType: 'json',
			 success: function(data) {
				bootbox.alert($.i18n('Configuration send to node. If the node is asleep, this could take a while!'));
			 },
			 error: function(){
					ShowNotify($.i18n('Problem updating Node Configuration!'), 2500, true);
			 }     
		});
	}
}

function ZWaveIncludeNode()
{
	$.ajax({
		 url: "json.htm?type=command&param=zwaveinclude&idx=" + $.devIdx,
		 async: false, 
		 dataType: 'json',
		 success: function(data) {
			bootbox.alert($.i18n('Inclusion mode Started. You have 20 seconds to include the device...!'));
		 }
	});
}
function ZWaveExcludeNode()
{
	$.ajax({
		 url: "json.htm?type=command&param=zwaveexclude&idx=" + $.devIdx,
		 async: false, 
		 dataType: 'json',
		 success: function(data) {
			bootbox.alert($.i18n('Exclusion mode Started. You have 20 seconds to exclude the device...!'));
		 }
	});
}

function ZWaveSoftResetNode()
{
	$.ajax({
		 url: "json.htm?type=command&param=zwavesoftreset&idx=" + $.devIdx,
		 async: false, 
		 dataType: 'json',
		 success: function(data) {
			bootbox.alert($.i18n('Soft resetting controller device...!'));
		 }
	});
}
function ZWaveHardResetNode()
{

	bootbox.confirm($.i18n("Are you sure you want to hard reset the controller?\n(All associated nodes will be removed)"), function(result) {
		if (result==true) {
			$.ajax({
				 url: "json.htm?type=command&param=zwavehardreset&idx=" + $.devIdx,
				 async: false, 
				 dataType: 'json',
				 success: function(data) {
					bootbox.alert($.i18n('Hard resetting controller device...!'));
				 }
			});
		}
	});


}

function ZWaveHealNetwork()
{
	$.ajax({
		 url: "json.htm?type=command&param=zwavenetworkheal&idx=" + $.devIdx,
		 async: false, 
		 dataType: 'json',
		 success: function(data) {
			bootbox.alert($.i18n('Initiating network heal...!'));
		 }
	});
}


function showNetworkInfo()
{
	$.ajax({
		url: "json.htm?type=command&param=zwavenetworkinfo&idx=" + $.devIdx,
		async: false, 
		dataType: 'json',
		success: function(data) {
			if (typeof data != 'undefined') {
				if (data.status=="OK") {
					var devicestates = "<div style='overflow:scroll; overflow-x: hidden; height: 500px;'><table><thead><tr><th align='left' style='padding-right: 80px;'>ID</th><th align='left' style='padding-right: 80px;'>Name</th><th align='left' style='padding-right: 80px;'>Current state</th><th align='left' style='padding-right: 80px;'>Last updated</th><th align='left' style='padding-right: 10px;'>sValues</th></tr></thead><tbody>";
					if (typeof data.result != 'undefined') {
						
						$.each(data.result, function(i,item){
							if (item.name != "Unknown") {
								var oneitem = '<tr><td> '+item.val+' </td><td></td><td></td><td></td><td></td></tr>'; 
								devicestates += oneitem;
							}
						});
					}
					devicestates += "</tbody></table></div>";
					noty({
						text: devicestates,
						type: 'information',
						modal: true,
						buttons: [
						{addClass: 'btn btn-primary', text: 'Ok', onClick: function($noty) 
							{$noty.close();
								
							}
						}]
					});
				}
			}
		}
	});
}

function RefreshOpenZWaveNodeTable()
{
  $('#modal').show();

	$('#updelclr #nodeupdate').attr("class", "btnstyle3-dis");
	$('#updelclr #nodedelete').attr("class", "btnstyle3-dis");
	$("#hardwarecontent #configuration").html("");
	$("#hardwarecontent #nodeparamstable #nodename").val("");
	
  var oTable = $('#nodestable').dataTable();
  oTable.fnClearTable();
  
  $.ajax({
     url: "json.htm?type=openzwavenodes&idx="+$.devIdx,
     async: false, 
     dataType: 'json',
     success: function(data) {
      if (typeof data.result != 'undefined') {
        $.each(data.result, function(i,item){
			var status="ok";
			if (item.IsDead==true) {
				status="failed";
			}
			else if (item.IsAwake==false) {
				status="sleep";
			}
			var statusImg='<img src="images/' + status +'.png"/>';
			if (item.NodeID==1) {
				item.Description +='&nbsp;&nbsp;<span class="label label-info" onclick="showNetworkInfo();" onmouseover="cursorhand()" onmouseout="cursordefault()">Info</span>';
			}
			var addId = oTable.fnAddData( {
				"DT_RowId": item.idx,
				"Name": item.Name,
				"PollEnabled": item.PollEnabled,
				"Config": item.config,
				"IsAwake": item.IsAwake,
				"IsDead": item.IsDead,
                "0": item.NodeID,
                "1": item.Name,
				"2": item.Description,
				"3": item.PollEnabled,
				"4": statusImg,
			} );
        });
		/* Add a click handler to the rows - this could be used as a callback */
		$("#nodestable tbody tr").click( function( e ) {
			$('#updelclr #nodedelete').attr("class", "btnstyle3-dis");
			if ( $(this).hasClass('row_selected') ) {
				$(this).removeClass('row_selected');
				$('#updelclr #nodeupdate').attr("class", "btnstyle3-dis");
				$("#hardwarecontent #configuration").html("");
				$("#hardwarecontent #nodeparamstable #nodename").val("");
			}
			else {
				oTable.$('tr.row_selected').removeClass('row_selected');
				$(this).addClass('row_selected');
				$('#updelclr #nodeupdate').attr("class", "btnstyle3");
				var anSelected = fnGetSelected( oTable );
				if ( anSelected.length !== 0 ) {
					var data = oTable.fnGetData( anSelected[0] );
					var idx= data["DT_RowId"];
					$.myglobals.SelectedTimerIdx=idx;
					$("#updelclr #nodeupdate").attr("href", "javascript:UpdateNode(" + idx + ")");
					if (data["IsDead"]==true) {
						$('#updelclr #nodedelete').attr("class", "btnstyle3");
						$("#updelclr #nodedelete").attr("href", "javascript:DeleteNode(" + idx + ")");
					}
					$("#hardwarecontent #nodeparamstable #nodename").val(data["1"]);
					$('#hardwarecontent #nodeparamstable #EnablePolling').prop('checked',(data["PollEnabled"]=="true"));
					var iNode=parseInt(data["0"]);
					if (iNode<2) {
						$("#hardwarecontent #nodeparamstable #trEnablePolling").hide();
					}
					else {
						$("#hardwarecontent #nodeparamstable #trEnablePolling").show();
					}
					
					var szConfig="";
					if (typeof data["Config"] != 'undefined') {
						//Create configuration setup
						szConfig='<a class="btnstyle3" id="noderequeststoredvalues" data-i18n="RequestConfiguration" onclick="RequestZWaveConfiguration(' + idx + ');">Request current stored values from device</a><br /><br />';
						var bHaveConfiguration=false;
						$.each(data["Config"], function(i,item){
							bHaveConfiguration=true;
							if (item.type=="list") {
								szConfig+="<b>"+item.index+". "+item.label+":</b><br>";
								szConfig+='<select style="width:100%" class="combobox ui-corner-all" id="'+item.index+'">';
								var iListItem=0;
								var totListItems=parseInt(item.list_items);
								for (iListItem=0; iListItem<totListItems; iListItem++)
								{
									var szComboOption='<option value="' + iListItem + '"';
									var szOptionTxt=item.listitem[iListItem];
									if (szOptionTxt==item.value) {
										szComboOption+=' selected="selected"';
									}
									szComboOption+='>' + szOptionTxt +'</option>';
									szConfig+=szComboOption;
								}
								szConfig+='</select>'
								if (item.units!="") {
									szConfig+=' (' + item.units + ')';
								}
							}
							else {
								szConfig+="<b>"+item.index+". "+item.label+":</b> ";
								szConfig+='<input type="text" id="'+item.index+'" value="' + item.value + '" style="width: 50px; padding: .2em;" class="text ui-widget-content ui-corner-all" />';
								if (item.units!="") {
									szConfig+=' (' + item.units + ')';
								}
								szConfig+=" (" + $.i18n("actual") + ": " + item.value + ")";
							}
							szConfig+="<br />";
							if (item.help!="") {
								szConfig+=item.help+"<br>";
							}
							szConfig+="Last Update: " + item.LastUpdate;
							szConfig+="<br /><br />";
						});
						if (bHaveConfiguration==true) {
							szConfig+='<a class="btnstyle3" id="nodeapplyconfiguration" data-i18n="ApplyConfiguration" onclick="ApplyZWaveConfiguration(' + idx + ');" >Apply configuration for this device</a><br />';
						}
					}
					$("#hardwarecontent #configuration").html(szConfig);
				}
			}
		}); 
				
      }
     }
  });
  $('#modal').hide();
}

function EditOpenZWave(idx,name,Mode1,Mode2,Mode3,Mode4,Mode5)
{
	$.devIdx=idx;
	cursordefault();
	var htmlcontent = '';
	htmlcontent='<p><center><h2><span data-i18n="Device"></span>: ' + name + '</h2></center></p>\n';
	htmlcontent+=$('#openzwave').html();
	$('#hardwarecontent').html(GetBackbuttonHTMLTable('ShowHardware')+htmlcontent);
	$('#hardwarecontent').i18n();

	var oTable = $('#nodestable').dataTable( {
	  "sDom": '<"H"lfrC>t<"F"ip>',
	  "oTableTools": {
		"sRowSelect": "single",
	  },
	  "aaSorting": [[ 0, "desc" ]],
	  "bSortClasses": false,
	  "bProcessing": true,
	  "bStateSave": true,
	  "bJQueryUI": true,
	  "aLengthMenu": [[25, 50, 100, -1], [25, 50, 100, "All"]],
	  "iDisplayLength" : 25,
	  "sPaginationType": "full_numbers"
	} );

	$('#hardwarecontent #idx').val(idx);
	
	RefreshOpenZWaveNodeTable();
}

function SetOpenThermSettings()
{
  $.post("setopenthermsettings.webem", $("#hardwarecontent #openthermform").serialize(), function(data) {
   ShowHardware();
  });
}

function EditOpenTherm(idx,name,Mode1,Mode2,Mode3,Mode4,Mode5)
{
//Mode1=Outside Temperature Sensor DeviceIdx, 0=Not Using
	$.devIdx=idx;
	cursordefault();
	var htmlcontent = '';
	htmlcontent='<p><center><h2><span data-i18n="Device"></span>: ' + name + '</h2></center></p>\n';
	htmlcontent+=$('#opentherm').html();
	$('#hardwarecontent').html(GetBackbuttonHTMLTable('ShowHardware')+htmlcontent);
	$('#hardwarecontent').i18n();

	$('#hardwarecontent #idx').val(idx);
	$('#hardwarecontent #combooutsidesensor >option').remove();
	var option = $('<option />');
	option.attr('value', 0).text("Use Build In");
	$("#hardwarecontent #combooutsidesensor").append(option);
	
	$('#hardwarecontent #submitbuttonopentherm').click(function (e) {
		e.preventDefault();
		SetOpenThermSettings();
	});
	
	//Get Temperature Sensors
	$.ajax({
		 url: "json.htm?type=devices&filter=temp&used=true&order=Name",
		 async: false, 
		 dataType: 'json',
		 success: function(data) {
			if (typeof data.result != 'undefined') 
			{
				$.each(data.result, function(i,item){
					if (typeof item.Temp != 'undefined') {
						var option = $('<option />');
						option.attr('value', item.idx).text(item.Name+" ("+item.Temp +"\u00B0)");
						$("#hardwarecontent #combooutsidesensor").append(option);
					}
				});
			}
			$("#hardwarecontent #combooutsidesensor").val(Mode1);
		 }
	}); 
	$("#hardwarecontent #combooutsidesensor").val(Mode1);
}

function SetRFXCOMMode()
{
  $.post("setrfxcommode.webem", $("#hardwarecontent #settings").serialize(), function(data) {
   SwitchLayout('Dashboard');
  });
}

function SetRego6XXType()
{
  $.post("setrego6xxtype.webem", $("#hardwarecontent #regotype").serialize(), function(data) {
   ShowHardware();
  });
}

function SetS0MeterType()
{
  $.post("sets0metertype.webem", $("#hardwarecontent #s0metertype").serialize(), function(data) {
   ShowHardware();
  });
}

function SetLimitlessType()
{
  $.post("setlimitlesstype.webem", $("#hardwarecontent #limitform").serialize(), function(data) {
   ShowHardware();
  });
}

function CreateDummySensors(idx,name)
{
	$.devIdx=idx;
    $( "#dialog-createsensor" ).dialog({
          autoOpen: false,
          width: 380,
          height: 160,
          modal: true,
          resizable: false,
          buttons: {
              "OK": function() {
                  var bValid = true;
                  $( this ).dialog( "close" );
                  
					var SensorType=$("#dialog-createsensor #sensortype option:selected").val();
					if (typeof SensorType == 'undefined') {
						bootbox.alert($.i18n('No Sensor Type Selected!'));
						return ;
					}
					$.ajax({
						 url: "json.htm?type=createvirtualsensor&idx=" + $.devIdx + "&sensortype=" + SensorType,
						 async: false, 
						 dataType: 'json',
						 success: function(data) {
							if (data.status == 'OK') {
								ShowNotify($.i18n('Sensor Created, and can be found in the devices tab!'), 2500);
							}
							else {
								ShowNotify($.i18n('Problem creating Sensor!'), 2500, true);
							}
						 },
						 error: function(){
								HideNotify();
								ShowNotify($.i18n('Problem creating Sensor!'), 2500, true);
						 }     
					});
              },
              Cancel: function() {
                  $( this ).dialog( "close" );
              }
          },
          close: function() {
            $( this ).dialog( "close" );
          }
    });
	
	$( "#dialog-createsensor" ).i18n();
	$( "#dialog-createsensor" ).dialog( "open" );
}

function RefreshHardwareTable()
{
  $('#modal').show();

	$('#updelclr #hardwareupdate').attr("class", "btnstyle3-dis");
	$('#updelclr #hardwaredelete').attr("class", "btnstyle3-dis");

  var oTable = $('#hardwaretable').dataTable();
  oTable.fnClearTable();
  
  $.ajax({
     url: "json.htm?type=hardware", 
     async: false, 
     dataType: 'json',
     success: function(data) {
        
      if (typeof data.result != 'undefined') {
        $.each(data.result, function(i,item){

			var HwTypeStrOrg=$.myglobals.HardwareTypesStr[item.Type];
			var HwTypeStr=HwTypeStrOrg;
        
			if (typeof HwTypeStr == 'undefined') {
				HwTypeStr="???? Unknown (NA/Not supported)";
			}
        
			var SerialName="Unknown!?";
			if ((HwTypeStr.indexOf("LAN") >= 0)||(HwTypeStr.indexOf("Domoticz") >= 0))
			{
				SerialName=item.Port;
			}
			else if ((item.Type == 7)||(item.Type == 11))
			{
				SerialName="USB";
			}
			else if (item.Type == 12)
			{
				SerialName="System";
			}
			else if (item.Type == 13)
			{
				SerialName="I2C";
			}
			else if ((item.Type == 14)||(item.Type == 25))
			{
				SerialName="WWW";
			}
			else if (item.Type == 15)
			{
				SerialName="";
			}
			else if (item.Type == 16)
			{
				SerialName="GPIO";
			}
			else
			{
				var serpos=jQuery.inArray(item.Port, $.myglobals.SerialPortVal);
				if (serpos!=-1) {
					SerialName=$.myglobals.SerialPortStr[serpos];
				}
			}

			var enabledstr="No";
			if (item.Enabled=="true") {
				enabledstr="Yes";
			}
			if (
				(HwTypeStr.indexOf("RFXtrx433 USB") >= 0)||
				(HwTypeStr.indexOf("RFXtrx315 USB") >= 0)
			   )
			{
				HwTypeStr+='<br>Firmware version: ' + item.Mode2;
				HwTypeStr+=' <span class="label label-info" onclick="EditRFXCOMMode(' + item.idx + ',\'' + item.Name + '\',' + item.Mode1 + ',' + item.Mode2+ ',' + item.Mode3+ ',' + item.Mode4+ ',' + item.Mode5 + ');" onmouseover="cursorhand()" onmouseout="cursordefault()">Set Mode</span>';
			}
			else if (HwTypeStr.indexOf("S0 Meter USB") >= 0) {
				HwTypeStr+=' <span class="label label-info" onclick="EditS0MeterType(' + item.idx + ',\'' + item.Name + '\',' + item.Mode1 + ',' + item.Mode2+ ',' + item.Mode3+ ',' + item.Mode4+ ',' + item.Mode5 + ');" onmouseover="cursorhand()" onmouseout="cursordefault()">Set Mode</span>';
			}
			else if (HwTypeStr.indexOf("Limitless") >= 0) {
				HwTypeStr+=' <span class="label label-info" onclick="EditLimitlessType(' + item.idx + ',\'' + item.Name + '\',' + item.Mode1 + ',' + item.Mode2+ ',' + item.Mode3+ ',' + item.Mode4+ ',' + item.Mode5 + ');" onmouseover="cursorhand()" onmouseout="cursordefault()">Set Mode</span>';
			}
			else if (HwTypeStr.indexOf("OpenZWave") >= 0) {
				HwTypeStr+=' <span class="label label-info" onclick="EditOpenZWave(' + item.idx + ',\'' + item.Name + '\',' + item.Mode1 + ',' + item.Mode2+ ',' + item.Mode3+ ',' + item.Mode4+ ',' + item.Mode5 + ');" onmouseover="cursorhand()" onmouseout="cursordefault()">Setup</span>';
			}
			else if (HwTypeStr.indexOf("OpenTherm") >= 0) {
				HwTypeStr+=' <span class="label label-info" onclick="EditOpenTherm(' + item.idx + ',\'' + item.Name + '\',' + item.Mode1 + ',' + item.Mode2+ ',' + item.Mode3+ ',' + item.Mode4+ ',' + item.Mode5 + ');" onmouseover="cursorhand()" onmouseout="cursordefault()">Setup</span>';
			}
			else if (HwTypeStr.indexOf("Dummy") >= 0) {
				HwTypeStr+=' <span class="label label-info" onclick="CreateDummySensors(' + item.idx + ',\'' + item.Name + '\');" onmouseover="cursorhand()" onmouseout="cursordefault()">Create Virtual Sensors</span>';
			}
			else if (HwTypeStr.indexOf("Rego 6XX") >= 0)
			{
				HwTypeStr+='<br>Type: ';
				if (item.Mode1=="0")
				{
					HwTypeStr+='600-635, 637 single language';
				}
				else if(item.Mode1=="1")
				{
					HwTypeStr+='636';
				}
				else if(item.Mode1=="2")
				{
					HwTypeStr+='637 multi language';
				}
				HwTypeStr+=' <span class="label label-info" onclick="EditRego6XXType(' + item.idx + ',\'' + item.Name + '\',' + item.Mode1 + ',' + item.Mode2+ ',' + item.Mode3+ ',' + item.Mode4+ ',' + item.Mode5 + ');" onmouseover="cursorhand()" onmouseout="cursordefault()">Change Type</span>';
			}
					
			var addId = oTable.fnAddData( {
				"DT_RowId": item.idx,
				"Username": item.Username,
				"Password": item.Password,
				"Enabled": item.Enabled,
				"Mode1": item.Mode1,
				"Mode2": item.Mode2,
				"Mode3": item.Mode3,
				"Mode4": item.Mode4,
				"Mode5": item.Mode5,
				"Type" : HwTypeStrOrg,
				"IntPort": item.Port,
                "0": item.Name,
                "1": enabledstr,
				"2": HwTypeStr,
				"3": item.Address,
				"4": SerialName
			} );
        });
		/* Add a click handler to the rows - this could be used as a callback */
		$("#hardwaretable tbody tr").click( function( e ) {
			if ( $(this).hasClass('row_selected') ) {
				$(this).removeClass('row_selected');
				$('#updelclr #hardwareupdate').attr("class", "btnstyle3-dis");
				$('#updelclr #hardwaredelete').attr("class", "btnstyle3-dis");
			}
			else {
				oTable.$('tr.row_selected').removeClass('row_selected');
				$(this).addClass('row_selected');
				$('#updelclr #hardwareupdate').attr("class", "btnstyle3");
				$('#updelclr #hardwaredelete').attr("class", "btnstyle3");
				var anSelected = fnGetSelected( oTable );
				if ( anSelected.length !== 0 ) {
					var data = oTable.fnGetData( anSelected[0] );
					var idx= data["DT_RowId"];
					$.myglobals.SelectedTimerIdx=idx;
					$("#updelclr #hardwareupdate").attr("href", "javascript:UpdateHardware(" + idx + "," + data["Mode1"] + "," + data["Mode2"] + "," + data["Mode3"] + "," + data["Mode4"] + "," + data["Mode5"] + ")");
					$("#updelclr #hardwaredelete").attr("href", "javascript:DeleteHardware(" + idx + ")");
					$("#hardwarecontent #hardwareparamstable #hardwarename").val(data["0"]);
					$("#hardwarecontent #hardwareparamstable #combotype").val(jQuery.inArray(data["Type"], $.myglobals.HardwareTypesStr));

					$('#hardwarecontent #hardwareparamstable #enabled').prop('checked',(data["Enabled"]=="true"));

					UpdateHardwareParamControls();
					if ((data["Type"].indexOf("TE923") >= 0)||(data["Type"].indexOf("Volcraft") >= 0)||(data["Type"].indexOf("1-Wire") >= 0)||(data["Type"].indexOf("BMP085") >= 0)||(data["Type"].indexOf("Dummy") >= 0) ||(data["Type"].indexOf("PiFace") >= 0))
					{
						//nothing to be set
					}
					else
					if (data["Type"].indexOf("USB") >= 0)
					{
						$("#hardwarecontent #hardwareparamsserial #comboserialport").val(data["IntPort"]);
					}
					else
					if (((data["Type"].indexOf("LAN") >= 0) && (data["Type"].indexOf("YouLess") == -1)) ||(data["Type"].indexOf("Domoticz") >= 0))
					{
						$("#hardwarecontent #hardwareparamsremote #tcpaddress").val(data["3"]);
						$("#hardwarecontent #hardwareparamsremote #tcpport").val(data["4"]);
					}
					else
					if (((data["Type"].indexOf("LAN") >= 0) && (data["Type"].indexOf("YouLess") >= 0)) ||(data["Type"].indexOf("Domoticz") >= 0))
					{
						$("#hardwarecontent #hardwareparamsremote #tcpaddress").val(data["3"]);
						$("#hardwarecontent #hardwareparamsremote #tcpport").val(data["4"]);
						$("#hardwarecontent #hardwareparamslogin #password").val(data["Password"]);
					}
					else
					if ((data["Type"].indexOf("Underground") >= 0)||(data["Type"].indexOf("Forecast") >= 0))
					{
						$("#hardwarecontent #hardwareparamsunderground #apikey").val(data["Username"]);
						$("#hardwarecontent #hardwareparamsunderground #location").val(data["Password"]);
					}
					if (data["Type"].indexOf("Domoticz") >= 0) {
						$("#hardwarecontent #hardwareparamslogin #username").val(data["Username"]);
						$("#hardwarecontent #hardwareparamslogin #password").val(data["Password"]);
					}
				}
			}
		}); 
				
      }
     }
  });
  $('#modal').hide();
}

function UpdateHardwareParamControls()
{
	var text = $("#hardwarecontent #hardwareparamstable #combotype option:selected").text();

	$("#hardwarecontent #username").show();
	$("#hardwarecontent #lblusername").show();
			

	if ((text.indexOf("TE923") >= 0)||(text.indexOf("Volcraft") >= 0)||(text.indexOf("BMP085") >= 0)||(text.indexOf("Dummy") >= 0)||(text.indexOf("PiFace") >= 0))
	{
		$("#hardwarecontent #divserial").hide();
		$("#hardwarecontent #divremote").hide();
		$("#hardwarecontent #divlogin").hide();
		$("#hardwarecontent #divunderground").hide();
	}
	else if (text.indexOf("USB") >= 0)
	{
		$("#hardwarecontent #divserial").show();
		$("#hardwarecontent #divremote").hide();
		$("#hardwarecontent #divlogin").hide();
		$("#hardwarecontent #divunderground").hide();
	}
	else if (text.indexOf("LAN") >= 0 && text.indexOf("YouLess") == -1)
	{
		$("#hardwarecontent #divserial").hide();
		$("#hardwarecontent #divremote").show();
		$("#hardwarecontent #divlogin").hide();
		$("#hardwarecontent #divunderground").hide();
	}
	else if (text.indexOf("LAN") >= 0 && text.indexOf("YouLess") >= 0)
	{
		$("#hardwarecontent #divserial").hide();
		$("#hardwarecontent #divremote").show();
		$("#hardwarecontent #divlogin").show();
		$("#hardwarecontent #username").hide();
		$("#hardwarecontent #lblusername").hide();
		$("#hardwarecontent #divunderground").hide();
	}
	else if (text.indexOf("Domoticz") >= 0)
	{
		$("#hardwarecontent #divserial").hide();
		$("#hardwarecontent #divremote").show();
		$("#hardwarecontent #divlogin").show();
		$("#hardwarecontent #divunderground").hide();
	}
	else if ((text.indexOf("Underground") >= 0)||(text.indexOf("Forecast") >= 0))
	{
		$("#hardwarecontent #divserial").hide();
		$("#hardwarecontent #divremote").hide();
		$("#hardwarecontent #divlogin").hide();
		$("#hardwarecontent #divunderground").show();
	}
	else
	{
		$("#hardwarecontent #divserial").hide();
		$("#hardwarecontent #divremote").hide();
		$("#hardwarecontent #divlogin").hide();
		$("#hardwarecontent #divunderground").hide();
	}
}

function ShowHardware()
{
	$('#modal').show();
	var htmlcontent = "";
	htmlcontent+=$('#hardwaremain').html();
	$('#hardwarecontent').html(htmlcontent);
	$('#hardwarecontent').i18n();
	var oTable = $('#hardwaretable').dataTable( {
	  "sDom": '<"H"lfrC>t<"F"ip>',
	  "oTableTools": {
		"sRowSelect": "single",
	  },
	  "aaSorting": [[ 0, "desc" ]],
	  "bSortClasses": false,
	  "bProcessing": true,
	  "bStateSave": true,
	  "bJQueryUI": true,
	  "aLengthMenu": [[25, 50, 100, -1], [25, 50, 100, "All"]],
	  "iDisplayLength" : 25,
	  "sPaginationType": "full_numbers"
	} );

	$("#hardwarecontent #hardwareparamstable #combotype").change(function() { 
		UpdateHardwareParamControls();
	});
	
	$('#modal').hide();
	RefreshHardwareTable();
	UpdateHardwareParamControls();
}


$(document).ready(function() {
	//global var
	$.devIdx=0;
	$.myglobals = {
		HardwareTypesStr : [],
		SerialPortVal : [],
		SerialPortStr : [],
		SelectedHardwareIdx: 0
	};
	$('#hardwareparamstable #combotype > option').each(function() {
		 $.myglobals.HardwareTypesStr[$(this).val()]=$(this).text();
	});
	$('#hardwareparamsserial #comboserialport > option').each(function() {
		 $.myglobals.SerialPortStr.push($(this).text());
		 $.myglobals.SerialPortVal.push(parseInt($(this).val()));
	});
	
	ShowHardware();
} );  
</script>